#!/bin/bash

chemin=$PWD
installation=/home/kantena/rhizome/mvc
action=$1
complement_ou_nom=$2
nom_composant_a_creer=$3

if  test $action = "cree"
then
    if [ -f .racine ]
        then
            if [ $complement_ou_nom != "modele" ] && [ $complement_ou_nom != "vue" ] && [ $complement_ou_nom != "action" ] && [ $complement_ou_nom != "controleur" ]
                then
                    echo 'erreur de commande'
                else
                    echo "création d'un(e) $complement_ou_nom: $chemin/app/modele/modele_$nom_composant_a_creer.rb"
                    sed s/"<nom-$complement_ou_nom>"/"$complement_ou_nom_$nom_composant_a_creer"/g $installation/modeles/$complement_ou_nom.rb >> $chemin/app/$complement_ou_nom/$complement_ou_nom_$nom_composant_a_creer.rb
               fi
        else
            echo 'vous devez être a la racine de votre projet pour executer cette commande'
        fi

else

    if [ $action = "init" ]
    then
        echo "création de l'arborescence"
        liste="$complement_ou_nom $complement_ou_nom/lib $complement_ou_nom/test $complement_ou_nom/scripts $complement_ou_nom/app"
        liste="$liste $complement_ou_nom/app/vue $complement_ou_nom/app/controleur $complement_ou_nom/app/modele $complement_ou_nom/app/action"
        for doss in $liste
        do
            (mkdir $doss && echo Création de $doss) || echo Erreur lors de la création de $doss
        done

        touch $complement_ou_nom/.racine
    else
        echo 'aide de commande'

    fi
fi

